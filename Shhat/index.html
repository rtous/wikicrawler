<div class="mw-parser-output"><div class="center"><div class="floatnone"><a class="image" href="/pti/index.php/File:Shhat.png"><img alt="Shhat.png" data-file-height="140" data-file-width="462" decoding="async" height="140" src="/pti/images/1/1c/Shhat.png" width="462"/></a></div></div>
<div class="center"><div class="floatnone"><a class="image" href="/pti/index.php/File:Icon_shhat_-_copia.png"><img alt="Icon shhat - copia.png" data-file-height="300" data-file-width="300" decoding="async" height="300" src="/pti/images/c/c7/Icon_shhat_-_copia.png" width="300"/></a></div></div>
<div aria-labelledby="mw-toc-heading" class="toc" id="toc" role="navigation"><input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/><div class="toctitle" dir="ltr" lang="en"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Shhat"><span class="tocnumber">1</span> <span class="toctext">Shhat</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#El_proyecto_Shhat"><span class="tocnumber">1.1</span> <span class="toctext">El proyecto Shhat</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Objetivos"><span class="tocnumber">1.2</span> <span class="toctext">Objetivos</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Tecnolog.C3.ADas"><span class="tocnumber">1.3</span> <span class="toctext">Tecnologías</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#BlockChain"><span class="tocnumber">1.3.1</span> <span class="toctext">BlockChain</span></a>
<ul>
<li class="toclevel-4 tocsection-6"><a href="#Raz.C3.B3n_de_uso"><span class="tocnumber">1.3.1.1</span> <span class="toctext">Razón de uso</span></a></li>
<li class="toclevel-4 tocsection-7"><a href="#Implementaci.C3.B3n"><span class="tocnumber">1.3.1.2</span> <span class="toctext">Implementación</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-8"><a href="#BackEnd"><span class="tocnumber">1.3.2</span> <span class="toctext">BackEnd</span></a>
<ul>
<li class="toclevel-4 tocsection-9"><a href="#Raz.C3.B3n_de_uso_2"><span class="tocnumber">1.3.2.1</span> <span class="toctext">Razón de uso</span></a></li>
<li class="toclevel-4 tocsection-10"><a href="#Instalaci.C3.B3n"><span class="tocnumber">1.3.2.2</span> <span class="toctext">Instalación</span></a>
<ul>
<li class="toclevel-5 tocsection-11"><a href="#Caracter.C3.ADsticas_t.C3.A9cnicas"><span class="tocnumber">1.3.2.2.1</span> <span class="toctext">Características técnicas</span></a></li>
<li class="toclevel-5 tocsection-12"><a href="#Geth"><span class="tocnumber">1.3.2.2.2</span> <span class="toctext">Geth</span></a></li>
<li class="toclevel-5 tocsection-13"><a href="#Node"><span class="tocnumber">1.3.2.2.3</span> <span class="toctext">Node</span></a></li>
<li class="toclevel-5 tocsection-14"><a href="#Web3"><span class="tocnumber">1.3.2.2.4</span> <span class="toctext">Web3</span></a></li>
<li class="toclevel-5 tocsection-15"><a href="#Nohup"><span class="tocnumber">1.3.2.2.5</span> <span class="toctext">Nohup</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-16"><a href="#Implementaci.C3.B3n_2"><span class="tocnumber">1.3.2.3</span> <span class="toctext">Implementación</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-17"><a href="#Android"><span class="tocnumber">1.3.3</span> <span class="toctext">Android</span></a>
<ul>
<li class="toclevel-4 tocsection-18"><a href="#Raz.C3.B3n_de_uso_3"><span class="tocnumber">1.3.3.1</span> <span class="toctext">Razón de uso</span></a></li>
<li class="toclevel-4 tocsection-19"><a href="#Implementaci.C3.B3n_3"><span class="tocnumber">1.3.3.2</span> <span class="toctext">Implementación</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-20"><a href="#Web"><span class="tocnumber">1.3.4</span> <span class="toctext">Web</span></a>
<ul>
<li class="toclevel-4 tocsection-21"><a href="#Raz.C3.B3n_de_uso_4"><span class="tocnumber">1.3.4.1</span> <span class="toctext">Razón de uso</span></a></li>
<li class="toclevel-4 tocsection-22"><a href="#Implementaci.C3.B3n_4"><span class="tocnumber">1.3.4.2</span> <span class="toctext">Implementación</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-23"><a href="#P2P"><span class="tocnumber">1.3.5</span> <span class="toctext">P2P</span></a>
<ul>
<li class="toclevel-4 tocsection-24"><a href="#Raz.C3.B3n_de_uso_5"><span class="tocnumber">1.3.5.1</span> <span class="toctext">Razón de uso</span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Implementaci.C3.B3n_5"><span class="tocnumber">1.3.5.2</span> <span class="toctext">Implementación</span></a>
<ul>
<li class="toclevel-5 tocsection-26"><a href="#Servidor_Bootstrap"><span class="tocnumber">1.3.5.2.1</span> <span class="toctext">Servidor Bootstrap</span></a></li>
<li class="toclevel-5 tocsection-27"><a href="#Clase_Peer"><span class="tocnumber">1.3.5.2.2</span> <span class="toctext">Clase Peer</span></a></li>
<li class="toclevel-5 tocsection-28"><a href="#Implementaci.C3.B3n_en_android"><span class="tocnumber">1.3.5.2.3</span> <span class="toctext">Implementación en android</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Resultado_final_vs_esperado"><span class="tocnumber">2</span> <span class="toctext">Resultado final vs esperado</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#Privacidad_y_anonimato"><span class="tocnumber">2.1</span> <span class="toctext">Privacidad y anonimato</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-31"><a href="#Conclusiones"><span class="tocnumber">3</span> <span class="toctext">Conclusiones</span></a></li>
<li class="toclevel-1 tocsection-32"><a href="#Memoria"><span class="tocnumber">4</span> <span class="toctext">Memoria</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Shhat">Shhat</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=1" title="Edit section: Shhat">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=1" title="Edit section: Shhat">edit source</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="El_proyecto_Shhat">El proyecto Shhat</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=2" title="Edit section: El proyecto Shhat">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=2" title="Edit section: El proyecto Shhat">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>El proyecto “Shhat” surge con la idea de conseguir una herramienta con la que conseguir un mayor nivel de privacidad. 
Con esto en mente se ha creado un servicio de mensajería instantánea en el que los usuarios, a través de un cliente de Android o de una página web, pueden crear salas de chat privadas e invitar a sus contactos a ellas. 
</p><p>Para conseguir un nivel de privacidad adecuado, se ha optado por usar la tecnología BlockChain, muy comentada en la actualidad, para mantener la base de datos y la lógica de las salas de chat. Esto permite, además, que el coste del sistema sea muy bajo, ya que esta tecnología, como se explicará posteriormente, permite tener aplicaciones distribuidas de forma fácil, rápida y sin necesidad de servidores.
</p><p>Mantener la BlockChain sincronizada en todo momento es un requisito necesario para poder usar sus funcionalidades, por lo que se necesita disponer de un servidor que se encargue de ello y reciba y procese peticiones de interacción con la BlockChain enviadas por los usuarios.
</p><p>Las redes descentralizadas pueden ayudar a mantener niveles de privacidad y tolerancia a fallos más altos, por lo que se ha decidido usar tecnología P2P para el envío de mensajes entre los usuarios.
</p><p>Un alto nivel de accesibilidad y facilidad a la hora de usar la aplicación era algo que se tenía muy en mente, por lo que una aplicación para Android y un cliente web permitirán el uso del servicio de forma sencilla y directa. 
</p><p>En los siguientes puntos de la memoria se explicarán en detalle cada uno de los 5 grandes paquetes de trabajo y la estructura que forman en conjunto, además de su implementación y una breve guía para facilitar su uso. 
</p><p><br/>
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:382px;"><a class="image" href="/pti/index.php/File:Captura.PNG"><img alt="" class="thumbimage" data-file-height="280" data-file-width="380" decoding="async" height="280" src="/pti/images/d/dc/Captura.PNG" width="380"/></a> <div class="thumbcaption"><div class="magnify"><a class="internal" href="/pti/index.php/File:Captura.PNG" title="Enlarge"></a></div>Esquema general del proyecto</div></div></div></div>
<h2><span class="mw-headline" id="Objetivos">Objetivos</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=3" title="Edit section: Objetivos">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=3" title="Edit section: Objetivos">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>El objetivo principal del proyecto es crear un servicio de chat anónimo y descentralizado, desde el cual un usuario pueda comunicarse libremente, ya sea con uno o más usuarios, a través de salas de chat, con la confianza y la certeza de no ser rastreado, identificado, o relacionado de alguna manera con una conversación en concreto.
</p><p>Dada la tecnología Blockchain, los datos del usuario y chats serán almacenados en la red ethereum, en la cual se tiene la certeza de que nadie se podrá hacer pasar por ti. Tampoco se registrarán datos de las IP’s de los mensajes enviados en los chats dentro de la red ethereum, y lo más importante, no se guardará ningún dato privado del usuario que pueda relacionarlo con su identidad en la vida real, es decir, nadie sabrá quien es el usuario “user17”, ni su nombre real, ni dirección, ni e-mail, ni nada,  ya que en la red ethereum solo se guardará el usuario y la contraseña, dando así el máximo grado de anonimidad.
</p>
<h2><span id="Tecnologías"></span><span class="mw-headline" id="Tecnolog.C3.ADas">Tecnologías</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=4" title="Edit section: Tecnologías">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=4" title="Edit section: Tecnologías">edit source</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="BlockChain">BlockChain</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=5" title="Edit section: BlockChain">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=5" title="Edit section: BlockChain">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Para la persistencia de los dato, tal y como se ha comentado antes, se ha decidido usar la tecnología BlockChain. A continuación se explica el porqué de su uso, como se ha realizado su implementación y las dificultades encontradas durante el proyecto.
Finalmente se explica la experiencia personal sobre el uso de esta nueva tecnología.
</p>
<h4><span id="Razón_de_uso"></span><span class="mw-headline" id="Raz.C3.B3n_de_uso">Razón de uso</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=6" title="Edit section: Razón de uso">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=6" title="Edit section: Razón de uso">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Esta tecnología nos brinda todo lo que necesitamos para la realización del proyecto. Una base de datos distribuida y descentralizada que nos permite la disposición de los datos en cualquier momento, incluso si alguno de sus nodos llegase a fallar.
La seguridad que nos brinda ésta. El uso de claves pública/privada nos permite dar acceso de lectura/escritura a los usuarios que se quieran, impidiendo así que alguien pueda modificar su base de datos.
El anonimato que nos da debido a que cada usuario se identifica con su clave y no con una identificación directamente relacionada a él.
</p>
<h4><span id="Implementación"></span><span class="mw-headline" id="Implementaci.C3.B3n">Implementación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=7" title="Edit section: Implementación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=7" title="Edit section: Implementación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Para la implementación se ha usado un Smart Contract usando el lenguaje de programación Solidity.
</p>
<h3><span class="mw-headline" id="BackEnd">BackEnd</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=8" title="Edit section: BackEnd">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=8" title="Edit section: BackEnd">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span id="Razón_de_uso_2"></span><span class="mw-headline" id="Raz.C3.B3n_de_uso_2">Razón de uso</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=9" title="Edit section: Razón de uso">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=9" title="Edit section: Razón de uso">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>La principal razón del uso de un servidor ha sido la necesidad de tener los diferentes usuarios sincronizados a la blockChain. Si cada usuario tuviera que descargar y estar constantemente sincronizado con la blockChain sería necesaria una gran capacidad de almacenamiento por usuario (actualmente pesa unos 30 GB). Esto se hace insostenible ya que un usuario no estaría dispuesto a gastar tal cantidad de memoria para una aplicación. Por ello, se ha decidido colocar un servidor que sirva como intermediario entre los usuarios y la blockChain.
Esto podría vulnerar la propiedad antes citada sobre que el sistema es descentralizado. La idea es que cualquiera pueda instalarse este servidor y tener varios de estos funcionando a la vez.
Además, como el servidor solo actúa de intermediario no existe la posibilidad de ataque sobre la base de datos ya que es el smart contract, el que gestiona tanto la BD como sus permisos.
Se ha elegido crear un servidor usando NodeJS ya que existe Web3 (explicado anteriormente) que no es más que una librería en JavaScript que permite la interacción con el cliente Geth.
</p>
<h4><span id="Instalación"></span><span class="mw-headline" id="Instalaci.C3.B3n">Instalación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=10" title="Edit section: Instalación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=10" title="Edit section: Instalación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<h5><span id="Características_técnicas"></span><span class="mw-headline" id="Caracter.C3.ADsticas_t.C3.A9cnicas">Características técnicas</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=11" title="Edit section: Características técnicas">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=11" title="Edit section: Características técnicas">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<pre>   SO: Ubuntu 16.04.2 LTS (GNU/Linux 4.4.0-22-generic x86_64)
   RAM: 3GB
   Almacenamiento: 40GB
</pre>
<h5><span class="mw-headline" id="Geth">Geth</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=12" title="Edit section: Geth">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=12" title="Edit section: Geth">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Para instalar el cliente Geth se ha usado una instalación mediante PPA.
</p>
<pre>   sudo apt-get install software-properties-common
   sudo add-apt-repository -y ppa:ethereum/ethereum
   sudo apt-get update
   sudo apt-get install ethereum
</pre>
<p>Actualmente el servidor tiene la versión geth 1.6.1-stable.
</p>
<h5><span class="mw-headline" id="Node">Node</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=13" title="Edit section: Node">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=13" title="Edit section: Node">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Para instalar el Node se ha usado una instalación mediante PPA.
</p>
<pre>   sudo apt-get install software-properties-common
</pre>
<p>Actualmente el servidor tiene la versión Node v4.2.6.
</p>
<h5><span class="mw-headline" id="Web3">Web3</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=14" title="Edit section: Web3">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=14" title="Edit section: Web3">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Para instalar la API Web3 se ha usado una instalación mediante npm:
</p>
<pre>   npm install web3
</pre>
<p>Actualmente el servidor tiene la versión web3 0.19.0.
</p>
<h5><span class="mw-headline" id="Nohup">Nohup</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=15" title="Edit section: Nohup">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=15" title="Edit section: Nohup">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Para poder dejar los procesos tanto de Geth como de NodeJS ejecutándose en el servidor aún habiendo cerrado la consola usamos Nohup. Un ejemplo de como ejecutar node redirigiendo la salida al fichero log.txt:
</p>
<pre>   nohup node app.js &gt; log.txt 2&gt;&amp;1 &amp;
</pre>
<h4><span id="Implementación_2"></span><span class="mw-headline" id="Implementaci.C3.B3n_2">Implementación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=16" title="Edit section: Implementación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=16" title="Edit section: Implementación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Para la implementación del servidor se ha decidido dividir las llamadas en dos tipos: las que usan el Smart Contract y las que no. Para las primeras se ha asignado un endpoint del tipo “/executeContract/función”, mientras que para las segundas se ha asignado un endpoint del tipo “/función”.
</p>
<h3><span class="mw-headline" id="Android">Android</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=17" title="Edit section: Android">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=17" title="Edit section: Android">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span id="Razón_de_uso_3"></span><span class="mw-headline" id="Raz.C3.B3n_de_uso_3">Razón de uso</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=18" title="Edit section: Razón de uso">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=18" title="Edit section: Razón de uso">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Hoy en día el 49% de las personas del mundo usan un smartphone, y el 81% de estos usuarios lo hacen bajo la tecnología android. Por lo que creemos necesario que nuestro chat esté presente en esta plataforma. Esto hace posible que cualquiera de nuestro entorno pueda usar nuestro servicio y visualizar su funcionamiento. También se ha elegido esta tecnología ya que tenemos experiencia previa en el desarrollo de aplicaciones y dominio en el lenguaje Java.
</p>
<h4><span id="Implementación_3"></span><span class="mw-headline" id="Implementaci.C3.B3n_3">Implementación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=19" title="Edit section: Implementación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=19" title="Edit section: Implementación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>La aplicación se ha desarrollado con la herramienta de Android Studio bajo la versión sdk 25 que incluye todas las nuevas librerías y adaptada a los terminales que corran como mínimo con la versión 16 de Android. 
Para poder soportar todas estas funcionalidades, siguiendo la guía de uso de Android se ha distribuido la aplicación en los siguientes bloques:
</p><p><b>Activities:</b> Clases principales para gestionar las funcionalidades más específicas como AddUserActivity, DeleteChatActivity, LoginActivity, SignUpActivity o ChatActivity.
</p><p><b>Fragments:</b> Clases básicas de la aplicación. En estas clases se concentran las funcionalidades más generales y principales como es la gestión de las salas de chats y la gestión de usuarios.
</p><p><b>Adapters:</b> En este paquete están todas las clases que se encargan de gestionar los datos recibidos del servidor para integrarlos en todas las pantallas que los requieran.
</p><p><b>Managers:</b> Son instancias de la clase User y ChatRoom a modo de singleton, de manera que los datos más fundamentales del usuario y sus chats sean accesibles desde cualquier punto de la aplicación.
</p><p><b>Utils:</b> Todas las clases que implementan alguna funcionalidad complementaria pero necesaria para la lógica de la aplicación se encuentran en este apartado.
</p><p><b>Service:</b> Las llamadas al servidor se encuentran en este paquete.
</p><p><b>Modelos:</b> En este apartado, es dónde se encuentran los modelos de las distintas clases que componen el proyecto. En este caso son dos, el ModelUser y el ModelChat.
</p><p>Para acceder a la aplicación se ha de tener una cuenta en Ethereum. Una vez creada la cuenta en Ethereum se creará una contraseña en la aplicación desde la pantalla de sign up, introduciendo el username y la contraseña deseada para la aplicación.
</p><p>Tras registrarse, la aplicación redirigirá directamente a la pantalla de login donde se realizará la llamada a la función unlockAccount con el userAddress de la cuenta Ethereum para obtener toda la información relacionada con el usuario.
</p><p>Tras hacer la llamada al servidor y recibir todos los chats correspondientes al usuario, se gestionarán mediante los Managers y se crearán los Fragments para mostrarlos en el ChatFragment y en el ContactFragment, como se muestra a continuación.
</p><p>Desde la pantalla principal de chats, como se muestra en el diagrama de uso, se puede acceder a un chat.
</p><p>Se puede crear un chat nuevo, indicando el nombre del chat, que corresponderá al nombre de usuario con el que se desea hablar. Al clicar sobre el botón de añadir se creará automáticamente la sala de chat y una vez creada, se añadirá el usuario seleccionado.
</p><p>Por otra parte también se puede eliminar un chat ya creado de la misma manera, pero esta vez clicando sobre el icono de papelera situado en la ToolBar. Esta opción requerirá de confirmación posterior, para garantizar una mayor usabilidad de la aplicación.
</p><p>Aquí también encontraremos la opción de logOut, para cerrar la sesión iniciada y eliminar los datos almacenados sobre nuestra dirección usada para el P2P.
</p><p>Por último, para añadir contactos desde el ContactFragment, se ha de conocer la dirección de la cuenta Ether del usuario que queremos añadir. De esta manera garantizamos la anonimidad de los usuarios.
</p>
<h3><span class="mw-headline" id="Web">Web</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=20" title="Edit section: Web">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=20" title="Edit section: Web">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span id="Razón_de_uso_4"></span><span class="mw-headline" id="Raz.C3.B3n_de_uso_4">Razón de uso</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=21" title="Edit section: Razón de uso">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=21" title="Edit section: Razón de uso">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Aunque hoy en día la mayoría de los usuarios habituales usan aplicaciones móviles, las aplicaciones web también aportan una gran comodidad a sus consumidores como podemos ver con servicios como WhatsApp o Telegram. Además vimos que con la herramienta de Zeronet realizar la aplicación web nos aportaría un grado más de anonimidad al uso de nuestra aplicación.
Al pensar en esos factores pensamos que lo más apropiado sería también desarrollar la aplicación para uso en la web, además aprovechamos para profundizar más en la creación de webs en javascript, bootstrap y en aprender en la comunicación de estas con APIs o servicios externos.
</p>
<h4><span id="Implementación_4"></span><span class="mw-headline" id="Implementaci.C3.B3n_4">Implementación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=22" title="Edit section: Implementación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=22" title="Edit section: Implementación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>La web se ha desarrollado usando JavaScript para usar las llamadas a la API (usando a la vez una librería externa llamada Ajax)  y además gestionar el funcionamiento interno de la web. 
Además para guardar información hemos usado el localStorage en el que se pueden guardar diferentes variables para guardar los datos del usuario, token, etc…
</p>
<h3><span class="mw-headline" id="P2P">P2P</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=23" title="Edit section: P2P">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=23" title="Edit section: P2P">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span id="Razón_de_uso_5"></span><span class="mw-headline" id="Raz.C3.B3n_de_uso_5">Razón de uso</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=24" title="Edit section: Razón de uso">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=24" title="Edit section: Razón de uso">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Dada la naturaleza de la blockchain y la manera en la que se ejecutan las transacciones, nos podemos encontrar con tiempos de espera altos (hasta 60 segundos en algunos casos) hasta que se completa la transacción, esto provoca que no se tenga una sensación de chat “en directo”, ya que los mensajes pueden o no tardar, pero no será inmediato.
</p><p>Es por esto que surge la necesidad de usar otra tecnología que permita al usuario tener una sensación más real de chat mientras se comunica con otros usuarios conectados a Shhat, pero manteniendo nuestros principios e ideas de usar redes secundarias y no centrales para transmitir la información.
</p><p>Se va a estudiar la manera de implementar las librerías sip2peer desenvolupadas por la Univeritat degli Studi di Parma (<a class="external free" href="http://dsg.ce.unipr.it/" rel="nofollow">http://dsg.ce.unipr.it/</a>), las cuales implementan el protocolo SIP para comunicarse entre los nodos de la red p2p, para de esta manera, lograr que el usuario de Shhat pueda tener una sensación más real de chat cuando chatea en directo con un amigo que también está conectado, ya que el tiempo en transmitir un mensaje p2p de un dispositivo a otro es muy ràpido (100~200ms, en ámbito de red local).
</p>
<h4><span id="Implementación_5"></span><span class="mw-headline" id="Implementaci.C3.B3n_5">Implementación</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=25" title="Edit section: Implementación">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=25" title="Edit section: Implementación">edit source</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Extenderemos la clase ‘Peer’ que nos facilita sip2peer para poder crear un peer a nuestra medida, la cual se extiende de la clase ‘Node’, que es un nodo SIP , capaz de reconocer los dispositivos de red y abrir conexiones en un determinado puerto para escuchar a otros nodos p2p.
</p><p>En el caso más simple que usaremos, en red local, la gente de sip2peer nos presenta un escenario en el cual un nuevo nodo, antes de entrar en la red, deberá registrarse en el servidor Bootstrap Peer para que haya constancia de él en la red p2p, y una vez hecho el ‘join’, ya puede entrar en la red y comunicarse con los demás nodos.
</p>
<h5><span class="mw-headline" id="Servidor_Bootstrap">Servidor Bootstrap</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=26" title="Edit section: Servidor Bootstrap">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=26" title="Edit section: Servidor Bootstrap">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Como explicaba anteriormente, en todo momento queríamos eliminar todo tipo de servidor que nos obligará a registrar nuestros nodos en la red, pero claro, alguien necesita saber nuestra dirección en el momento que nos conectamos, ya que la IP irá cambiando dependiendo de la red en la que nos conectemos.
</p><p>Llegados a la conclusión de que en algún momento se debería pasar por un servidor para registrar nuestra IP, y teniendo ya un servidor que precisamente atendía peticiones de login y muchas más funciones del chat, decidimos intentar implementarlo en nuestro propio Backend, sin las tecnologías de Bootstrap server que nos facilitaban las librerías p2p.
</p><p>Quizás podríamos haber montado el servidor Bootstrap en el Backend, pero en realidad en nuestro escenario, un nodo p2p no necesitaba saber todos los nodos disponibles en su propia red (algo común en las redes p2p, ya que casi siempre se usan para compartir entre los máximos nodos posibles)... en nuestro escenario un nodo simplemente necesitará saber la dirección p2p del nodo con el que quiere comunicarse, no nos sirve de nada saber cuántos nodos hay en la red.
</p><p>De esta manera, implementamos unas llamadas en el servidor setP2P y getP2P, las cuales setearían nuestra dirección p2p en el servidor una vez hacemos login, y, cuando entráramos en una sala de chat con un compañero, le pediríamos la IP pública del compañero al servidor con getP2P, y de esta manera sabríamos si está conectado, y si está conectado la dirección p2p a la que enviar los mensajes.
</p>
<h5><span class="mw-headline" id="Clase_Peer">Clase Peer</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=27" title="Edit section: Clase Peer">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=27" title="Edit section: Clase Peer">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Se ha extendido la clase Peer para poder hacer nuestras llamadas personalizadas, de manera que cuando recibamos un mensaje p2p podamos actualizar nuestra actividad de chat.
</p><p>Cuando se crea un Peer, es decir un nuevo node p2p, deberemos crearlo con una clave que será el identificador dentro de la red p2p (en ámbito local no importa mucho, ya que se usará simplemente la IP local, pero igualmente necesita tener una key), el nombre del usuario del nodo, y el puerto en el que escuchará la conexión. El primer campo es opcional y sirve para indicar un fichero de configuración del nodo, pero en nuestro caso será null.
</p>
<h5><span id="Implementación_en_android"></span><span class="mw-headline" id="Implementaci.C3.B3n_en_android">Implementación en android</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=28" title="Edit section: Implementación en android">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=28" title="Edit section: Implementación en android">edit source</a><span class="mw-editsection-bracket">]</span></span></h5>
<p>Para implementarlo hemos cogido todas las librerías que nos facilitaba sip2peer y las hemos incluido en android.
</p><p>Al iniciar sesion y entrar dentro de la sala de chat, iniciaremos un nuevo peer, el cual tendrá una key p2p generada aleatoriamente, el nombre del usuario de Shhat, su IP, y su puerto, tal que así:
</p>
<pre>   Pol@192.168.1.36:50520

</pre>
<p>Esta será la dirección de contacto en la red p2p
</p>
<pre>   peer = new SimplePeer(null, key, userManager.getUser().getUsername(),  50250);

</pre>
<p>Con esta sentencia crearemos el peer.
</p><p>Una vez creado el peer, comunicaremos nuestra dirección p2p al servidor, para que los demás usuarios puedan saberla cuando la necesiten.
</p>
<pre>   String addr = peer.getContactAddressPeer();
   setP2PService(addr);

</pre>
<p>En nuestra versión actual, se puede ver cómo, una vez iniciada la sesión, nos aparece un mensaje en la aplicación el cual dice “Listening on address Miquel@192.168.1.36:50250”, mensaje meramente informativo, para ver que realmente estamos escuchando en esa dirección.
</p><p>Cuando cliquemos dentro de un chat y accedamos a la chatActivity, el peer se pasará entre las clases, de manera que pueda seguir escuchando en la dirección p2p.
</p>
<pre>   peer = userManager.getPeer();
   peer.setChatActivity(this);

</pre>
<p>También necesitaremos la dirección p2p de la persona con la que queremos hablar.
Si la persona con la que queremos hablar no está conectada, nos retornará un string vacío, por lo tanto no enviaremos el mensaje por p2p, y simplemente lo enviaremos a la blockchain, ya que sabemos con certeza que ese usuario no está en la red p2p en ese momento.La función sendToPeer enviará el mensaje a la dirección p2p de nuestro compañero de chat.
</p><p>Esta función la implementamos nosotros, aunque tampoco fue muy difícil, ya que los ejemplos que habíamos visto eran muy parecidos, pero normalmente más complejos.
Ahora simplemente nos queda tratar las recepciones de mensajes, simplemente cuando recibamos un mensaje, con la función onReceivedJSONMsg (enviamos los mensajes en formato JSON), comprobaremos que es de texto, y acto seguido le diremos a la chatActivity que se actualice con la función updateChat, le pasaremos el nombre de usuario, de esta manera solo se actualizará la sala de chat que tenga el nombre de la persona de la que hemos recibido el mensaje.
Al hacer ‘logout’ de la aplicación, deberemos parar el peer para que no se quede el socket abierto.
</p>
<h1><span class="mw-headline" id="Resultado_final_vs_esperado">Resultado final vs esperado</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=29" title="Edit section: Resultado final vs esperado">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=29" title="Edit section: Resultado final vs esperado">edit source</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>En esta sección se compararán los resultados obtenidos en el proyecto con los que se deseaba cumplir cuando se empezó con la idea.
Los principales objetivos que teníamos en nuestro proyecto eran obtener un servicio de mensajería fácil de usar, que no necesitase ser configurado para ser usado y con el que se consiguiera privacidad total y evitar cualquier tipo de censura.
</p>
<h3><span class="mw-headline" id="Privacidad_y_anonimato">Privacidad y anonimato</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=30" title="Edit section: Privacidad y anonimato">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=30" title="Edit section: Privacidad y anonimato">edit source</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Para conseguir el anonimato se pretendía enrutar el tráfico a través de Tor, de modo que todo usuario que se conectarse usase una dirección de Tor para la comunicación P2P. Esto se descartó debido a la complejidad que conllevaba, con lo que se ha perdido la posibilidad de conseguir anonimato.
Ahora, en su lugar, se usan las direcciones “normales” sin enmascarar, pero aún tenemos cierta privacidad ya que la dirección IP sólo puede obtenerse a través del Smart Contract, por lo que podemos asociar una dirección IP a una cuenta de Ethereum, pero nada más.
</p>
<h1><span class="mw-headline" id="Conclusiones">Conclusiones</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=31" title="Edit section: Conclusiones">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=31" title="Edit section: Conclusiones">edit source</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>Como primera conclusión podríamos decir que ha sido un experimento bastante interesante, pero quizás para el tema chat, en algunos casos puede tener un comportamiento un poco lento (añadir usuario, crear salas nuevas de chat, incluso a veces hacer login si tenemos muchas salas de chat), lo que no da al usuario una sensación muy cómoda, aun teniendo p2p, lo que hace que vaya mucho más rápido, pero quizás no triunfaría como plataforma de chat.
</p><p>En cambio, este estudio nos abre muchas puertas para otras opciones, como puede ser un chat en diferido, o algo parecido a aplicaciones que hemos visto anteriormente, como tener formato de foro o de blog.
</p><p>Estamos contentos con el trabajo realizado y con los conocimientos adquiridos a lo largo del proyecto. El trabajo en equipo ha sido destacable, debido a la necesidad de una continua integración con todas las plataformas. Lo que se podría remarcar, son las complicaciones que hemos tenido con la BlockChain debido al uso de laTestNet, la cual para una aplicación de chat instantáneo en ciertos momentos puede que no sea la mejor opción. Pero en definitiva, la mayoría de las expectativas del proyecto se han cumplido y se ha podido conseguir una versión base con los objetivos establecidos en la propuesta inicial.
</p>
<h1><span class="mw-headline" id="Memoria">Memoria</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a class="mw-editsection-visualeditor" href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;veaction=edit&amp;section=32" title="Edit section: Memoria">edit</a><span class="mw-editsection-divider"> | </span><a href="/pti/index.php?title=Categor%C3%ADa:Shhat&amp;action=edit&amp;section=32" title="Edit section: Memoria">edit source</a><span class="mw-editsection-bracket">]</span></span></h1>
<p><a href="/pti/index.php/File:Memoria.pdf" title="File:Memoria.pdf">File:Memoria.pdf</a>
</p>
<!-- 
NewPP limit report
Cached time: 20250710083831
Cache expiry: 86400
Dynamic content: false
Complications: []
CPU time usage: 0.023 seconds
Real time usage: 0.025 seconds
Preprocessor visited node count: 98/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
<!-- Saved in parser cache with key pti21:pcache:idhash:314-0!canonical and timestamp 20250710083831 and revision id 347
 -->
</div>